<div mat-dialog-title>
    <h2>
        Grocery Shopping @if (data.withFridge) {
        <mat-icon
            class="relative"
            [matTooltip]="dialogReadingInfo"
            matBadge="i"
            matBadgeSize="small"
            matBadgeColor="primary"
            aria-hidden="false"
            aria-label="Example date icon"
            fontIcon="kitchen">
        </mat-icon>
        }
    </h2>
    <h5 class="flex gap-2 text-gray-400">
        <mat-icon aria-hidden="false" aria-label="Example date icon" fontIcon="date_range"></mat-icon>
        {{ data.startDate | date: 'dd.MM.yyyy' }} -
        {{ data.endDate | date: 'dd.MM.yyyy' }}
    </h5>
</div>
<mat-dialog-content>
    <table mat-table [dataSource]="data.ingredients" class="mat-elevation-z0 sticky top-0">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">{{ element.ingredientName }}</td>
        </ng-container>

        <!-- Quantity Column -->
        <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef>Quantity</th>
            <td mat-cell *matCellDef="let element">{{ element.quantity }}</td>
        </ng-container>

        <!-- Unit Column -->
        <ng-container matColumnDef="unit">
            <th mat-header-cell *matHeaderCellDef>Unit</th>
            <td mat-cell *matCellDef="let element; let i = index">{{ element.unit }}</td>
        </ng-container>

        @if (editMode) {

        <ng-container matColumnDef="expiration-date">
            <th mat-header-cell *matHeaderCellDef>Expiration Date</th>
            <td mat-cell *matCellDef="let element; let i = index">
                <mat-form-field>
                    <input
                        matInput
                        [matDatepicker]="picker"
                        [formControl]="form.at(i).get('expirationDate') | asType: FormControl" />
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
            </td>
        </ng-container>
        }

        <tr mat-header-row *matHeaderRowDef="tableColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: tableColumns"></tr>
    </table>

    @if (data.fridgeIngredients.length > 0) {
    <h5 class="mt-5 flex gap-2 text-gray-400">
        <mat-icon aria-hidden="false" aria-label="Example date icon" fontIcon="event"></mat-icon>
        Fridge state on day
        {{ data.fridgeStateDate | date: 'dd.MM.yyyy hh:mm' }}
    </h5>
    <table mat-table [dataSource]="data.fridgeIngredients" class="mat-elevation-z0">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">{{ element.ingredientName }}</td>
        </ng-container>

        <!-- Quantity Column -->
        <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef>Quantity</th>
            <td mat-cell *matCellDef="let element">{{ element.quantity }}</td>
        </ng-container>

        <!-- Unit Column -->
        <ng-container matColumnDef="unit">
            <th mat-header-cell *matHeaderCellDef>Unit</th>
            <td mat-cell *matCellDef="let element; let i = index">{{ element.unit }}</td>
        </ng-container>

        <!-- Expiration Date Column -->
        <ng-container matColumnDef="expiration-date">
            <th mat-header-cell *matHeaderCellDef>Expiration Date</th>
            <td mat-cell *matCellDef="let element; let i = index">{{ element.expirationDate }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="tableFridgeColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: tableFridgeColumns"></tr>
    </table>
    }
</mat-dialog-content>
<mat-dialog-actions>
    <button mat-raised-button mat-dialog-close>Close</button>
    <button mat-raised-button (click)="onAddToFridge()">Add to fridge</button>
</mat-dialog-actions>
